---
title: "Trabajo Práctico Análisis de Duración"
author: "Karen Otterstedt Juan Sebastían Reines Urieles"
date: "2025-05-16"
output:
  pdf_document:
    latex_engine: xelatex
execute:
  warning: false
  message: false
---


```{r CHAT}
# holandaaaa se me ocurrió que podemos ir hablando por acá (igual pusé comentarios más abajo jeje)
```


```{r Librerias, include=FALSE}

library(readr)
library(tibble)
library(tidyverse)
library(dplyr)
library(knitr)
library(kableExtra)
library(RColorBrewer) # Paletas

```

```{r Cargando los datos, include = F}
# ------------ Cargando los datos  ------------
# Somos el grupo 7 así que nos corresponde el dataset 7:

datos <- read_csv("conjunto_grupo_7.csv")
View(datos)
summary(datos)

# Para ver paletas de colores: (Me gustó la RdBu)
# display.brewer.all()
```

_Variables_

 - ID: número de identificación del paciente

 - Tiempo: tiempo en meses desde el diagnóstico de la
           enfermedad crónica respiratoria hasta que presenta
           la complicación severa o termina su período de seguimiento

 - Complicacion:  indicadora  de  la  presencia  de  complicación
                  severa  (1:  Presente,  0: Censura)
                                                                             
 - Edad: edad del paciente al momento de iniciar su seguimiento
          (en años)

 - Sexo: sexo biológico del paciente

 - Fumador: indicadora de si el paciente es fumador activo o no

 - Actividad:  nivel  de  actividad  física  del  paciente  categorizado
               en  actividad  baja, moderada o alta

 - Comorbilidades: número de comorbilidades que presenta el paciente
                   (el 0 indica que no tiene ninguna comorbilidad)

   presencia de dos o más enfermedades o afecciones en una misma
   persona al mismo tiempo



```{r Analisis Descriptivo, echo=FALSE}

# ------------ Análisis descriptivo ------------

 # IDEAS:
 # - Histograma de edad
 # - Diagrama de torta de sexo biológico?
 # - Boxplot de los tiempos para fumadores/ no fumadores?
 # - Boxplot de los tiempos para distintos niveles de actividad física?

# Histograma:
# VER
ggplot(datos, aes(x = edad)) +
  geom_histogram(fill = "skyblue", color = "white" ) +
  theme_bw()
```

```{r Fumadores, echo  = F}
# Boxplot fumadores:
#
#  hola juaaaan quería poner una paleta de colores y le estaba preguntando cosas al chat pero metengoqueiracomer así que pushié hasta donde quedé, pero la idea era poner mejor los colores, no me gusta que parece blanco el segundo boxplot (cosas irrelevantes pero weno tocs)
#  después de comer seguramente siga, nos vamo mandandoo 
datos %>% 
  group_by(fumador) %>% 
  ggplot(aes(x = fumador, y = tiempo, fill = fumador)) + 
  geom_boxplot() +
  scale_fill_brewer(palette = "RdBu")+
  theme_bw()

```

```{r Actividad, echo = F}
#BORRAR ???
 # VER si usar o no 
# datos %>% 
#   group_by(actividad) %>% 
#   ggplot(aes(x = actividad, y = tiempo)) + 
#   geom_boxplot() +
#   theme_bw()


 # BORRAR????
# Intentando una tabla, capaz es más útil que un gráfico en este caso:
# datos %>% 
#   group_by(actividad) %>% 
#   summarise(
#      n = n(),
#     media = mean(tiempo),
#     mediana = median(tiempo),
#     sd = sd(tiempo)
#    )


# DEJAR ESTA ?
# Esta me gusta más:
datos %>% 
  mutate(
    actividad = str_to_title(as.character(actividad)),
        actividad = factor(actividad,
                       levels = c("Alta", "Moderada", "Baja"))
) %>% 
  group_by(actividad) %>% 
  summarise(
    n = n(),
    media = mean(tiempo),
    mediana = median(tiempo),
    sd = sd(tiempo)
  ) %>%
  mutate(
    across(where(is.numeric),
           ~round(.x, 2))) %>%
  kable(    
    caption = "Medidas descriptivas de los pacientes según nivel de actividad física",
    col.names = c("Actividad","n", "Media", "Mediana", "Desvío estándar")) %>% 
      kable_styling(latex_options = c("responsive", "hold_position"))



```

```{r Comorbilidad, echo = F}
# Comorbilidad:
ggplot(datos, aes(x = tiempo, y = comorbilidades)) +
  geom_count(aes(alpha = after_stat(n)), shape = 16, size = 3) +
  scale_alpha(range = c(0.3, 1)) +
  theme_bw()


```




















